
@using XinTuo.Accounts.Models;
@{ 
    List<AccountCategoryRecord> cates = Model.Category;
}

<div class="easyui-layout" data-options="fit:true" >
    <div data-options="region:'north',split:false" style="height:100px;padding:10px;">
        @foreach (AccountCategoryRecord c in cates)
        {
            <a href="javascript:void(0)" id="cate_@c.Id" class="easyui-linkbutton" data-options="iconCls:'icon-large-picture',size:'large',iconAlign:'top',toggle:true,group:'g1'" onclick="varObject.mainCate=@c.Id">@c.CateName</a>
        }
    </div>
    <div data-options="region:'center'" style="padding:10px;">
        <table class="easyui-datagrid" id="accDatagrid"
               data-options="singleSelect:true,toolbar: '#accToolbar',fit:true,idField:'AccCode'">
            <thead>
                <tr>
                    <th data-options="field:'AccCode'">@T("编码")</th>
                    <th data-options="field:'AccName'">@T("名称")</th>
                    <th data-options="field:'CateName'">@T("类别")</th>
                    <th data-options="field:'Direction'">@T("余额方向")</th>
                    <th data-options="field:'AuxNames'">@T("辅助核算")</th>
                    <th data-options="field:'Unit'">@T("数量单位")</th>
                    <th data-options="field:'AccState'">@T("状态")</th>
                </tr>
            </thead>
        </table>

        <div id="accToolbar">
            <a href="javascript:void(0)" class="easyui-linkbutton" data-options="plain:true" onclick="append()">新增</a>
            <a href="javascript:void(0)" class="easyui-linkbutton" data-options="plain:true" onclick="appendSub()">新增下级</a>
            <a href="javascript:void(0)" class="easyui-linkbutton" data-options="plain:true" onclick="edit()">编辑</a>
            <a href="javascript:void(0)" class="easyui-linkbutton" data-options="plain:true" onclick="remove()">删除</a>
        </div>
    </div>
</div>

<div id="editDialog" class="easyui-dialog" title="编辑科目" style="width:450px;height:600px;" data-options="resizable:false,modal:true,closed: true,onBeforeOpen:editOnBeforeOpen">
    <form id="accForm" method="post">

        <div>
            <input class="easyui-textbox" id="AccCode" name="AccCode" data-options="label:'@T("科目编码")',required:true" style="width:100%;height:32px">
        </div>

        <div>
            <input class="easyui-textbox" id="AccName" name="AccName" data-options="label:'@T("科目名称")',required:true" style="width:100%;height:32px">
        </div>

        <div>
            <input class="easyui-textbox" id="ParentCode" name="ParentCode" data-options="label:'@T("上级科目")',required:true" style="width:100%;height:32px">
        </div>

        <div>
            <input class="easyui-combobox" id="CateId" name="CateId" data-options="label:'@T("科目类别")',required:true,valueField:'id',textField:'cateName',method: 'GET'" style="width:100%;height:32px">
        </div>

        <div>
            <label for="dirGroup" style="display:inline-block;" class="textbox-label textbox-label-before">余额方向</label>
            <fieldset id="dirGroup" style="display:inline;">
                <input type="radio" id="dirDebit" name="dir" value="debit" /><label for="dirDebit" style="display:inline;font-size:14pt;font-weight:bold;margin-right:10px;">借</label> 
                <input type="radio" id="dirCredit" name="dir" value="credit" /><label for="dirCredit" style="display:inline;font-size:14pt;font-weight:bold;">贷</label>
            </fieldset>
        </div>

        <div>
            <input type="checkbox" id="aux" name="aux" /><label for="aux">辅助核算</label>
            <div id="auxItems">

            </div>
        </div>

        <div style="text-align:right;">
            <a href="javascript:void(0)" class="easyui-linkbutton" onclick="save()" style="width:80px">确 定</a>
            <a href="javascript:void(0)" class="easyui-linkbutton" onclick="cancel()" style="width:80px">取 消</a>
        </div>

    </form>
</div>

<style type="text/css">
    #accForm div{
        padding:20px;
    }
</style>

<script type="text/javascript">

    var varObject = {
        mainCate:-1
    };

    $(function () {
        
    });

    function append()
    {
        $("#editDialog").dialog('open');
    }

    function editOnBeforeOpen()
    {
        $("#CateId").combobox('reload', '/api/a/GetSubAccCate?cid=' + varObject.mainCate);
    }


    function cancel()
    {
        $('#accForm').form('clear');
        $("#editDialog").dialog('close');
    }
</script>